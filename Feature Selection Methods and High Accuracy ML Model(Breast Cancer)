# -*- coding: utf-8 -*-
"""Untitled9.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Xw2bGQpHNHqa8S9Tk5I4hW2ZfJ0P_T_n
"""

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.feature_selection import SelectKBest, f_classif, RFE
from sklearn.metrics import accuracy_score

df=pd.read_csv("/content/breast-cancer.csv")

df

df.isnull().sum()

X = df.drop('diagnosis', axis=1)
y = df['diagnosis']

X

y

X_new = SelectKBest(f_classif, k=10).fit_transform(X, y)

X_new

rfe = RFE(RandomForestClassifier(), n_features_to_select=10)
X_new_rfe = rfe.fit_transform(X, y)

rf = RandomForestClassifier().fit(X, y)
importances = rf.feature_importances_
indices = importances.argsort()[-10:]

X_embedded = X.iloc[:, indices]

X_train, X_test, y_train, y_test = train_test_split(X_embedded, y, test_size=0.3, random_state=42)
clf = RandomForestClassifier()
clf.fit(X_train, y_train)
pred = clf.predict(X_test)

clf

pred

acc = accuracy_score(y_test, pred)
print(f"Model Accuracy: {acc*100:.2f}%")

import pickle
pickle.dump(clf,open('Breast Cancer.pkl','wb'))
model=pickle.load(open('Breast Cancer.pkl','rb'))
